gold = goldEarned
)
dfprep = adc.performance.patch %>%
mutate(DPS = totalDamageToChampions/gameDuration) %>%
mutate(patch2 =
dplyr::case_when(patch %in% c("6.23", "6.24") ~ "Pre-Season",
patch %in% c("7.1", "7.2", "7.3") ~ "7.1-7.3",
patch == "7.4" ~ "7.4",
patch == "7.5" ~ "7.5",
patch %in% c("7.6", "7.7", "7.8") ~ "7.6-7.8",
patch %in% c("7.9", "7.10") ~ "7.9-7.10",
patch %in% c("7.11", "7.12", "7.13") ~ "7.11-7.13",
patch %in% c("7.14", "7.15", "7.16", "7.17", "7.18") ~ "7.14-7.18",
TRUE                     ~ "undefined")) %>%
select(
name, patch,
games,
#summoners,
winrate,
#DPS,
DmgDealt = totalDamageToChampions,
kills,
assists,
deaths,
DmgTaken = totalDamageTaken,
cs = csPerGame,
gold = goldEarned
)
df = dfprep %>%
rownames_to_column( var = "champ" ) %>%
mutate_each(funs(rescale), -c(champ,name,patch2)) %>%
melt(id.vars=c('champ','name','patch2'), measure.vars=colnames(dfprep[,-c("name","patch2")])) %>%
arrange(champ)
df = data.table(df)
dfprep = adc.performance.patch %>%
mutate(DPS = totalDamageToChampions/gameDuration) %>%
mutate(patch2 =
dplyr::case_when(patch %in% c("6.23", "6.24") ~ "Pre-Season",
patch %in% c("7.1", "7.2", "7.3") ~ "7.1-7.3",
patch == "7.4" ~ "7.4",
patch == "7.5" ~ "7.5",
patch %in% c("7.6", "7.7", "7.8") ~ "7.6-7.8",
patch %in% c("7.9", "7.10") ~ "7.9-7.10",
patch %in% c("7.11", "7.12", "7.13") ~ "7.11-7.13",
patch %in% c("7.14", "7.15", "7.16", "7.17", "7.18") ~ "7.14-7.18",
TRUE                     ~ "undefined")) %>%
select(
name, patch,
games,
#summoners,
winrate,
#DPS,
DmgDealt = totalDamageToChampions,
kills,
assists,
deaths,
DmgTaken = totalDamageTaken,
cs = csPerGame,
gold = goldEarned
)
dfprep = data.table(dfprep)
df = dfprep %>%
rownames_to_column( var = "champ" ) %>%
mutate_each(funs(rescale), -c(champ,name,patch2)) %>%
melt(id.vars=c('champ','name','patch2'), measure.vars=colnames(dfprep[,-c("name","patch2")])) %>%
arrange(champ)
df = data.table(df)
df = dfprep %>%
rownames_to_column( var = "champ" ) %>%
mutate_each(funs(rescale), -c(champ,name,patch)) %>%
melt(id.vars=c('champ','name','patch'), measure.vars=colnames(dfprep[,-c("name","patch")])) %>%
arrange(champ)
df = data.table(df)
### attempt to illustrate specific traits of adcs
# OVERALL
dfprep = adc.performance.patch %>%
mutate(DPS = totalDamageToChampions/gameDuration) %>%
mutate(patch2 =
dplyr::case_when(patch %in% c("6.23", "6.24") ~ "Pre-Season",
patch %in% c("7.1", "7.2", "7.3") ~ "7.1-7.3",
patch == "7.4" ~ "7.4",
patch == "7.5" ~ "7.5",
patch %in% c("7.6", "7.7", "7.8") ~ "7.6-7.8",
patch %in% c("7.9", "7.10") ~ "7.9-7.10",
patch %in% c("7.11", "7.12", "7.13") ~ "7.11-7.13",
patch %in% c("7.14", "7.15", "7.16", "7.17", "7.18") ~ "7.14-7.18",
TRUE                     ~ "undefined")) %>%
select(
name, patch,
games,
#summoners,
winrate,
#DPS,
DmgDealt = totalDamageToChampions,
kills,
assists,
deaths,
DmgTaken = totalDamageTaken,
cs = csPerGame,
gold = goldEarned
)
dfprep = data.table(dfprep)
dfprep
### attempt to illustrate specific traits of adcs
# OVERALL
dfprep = adc.performance.patch %>%
mutate(DPS = totalDamageToChampions/gameDuration) %>%
mutate(patch2 =
dplyr::case_when(patch %in% c("6.23", "6.24") ~ "Pre-Season",
patch %in% c("7.1", "7.2", "7.3") ~ "7.1-7.3",
patch == "7.4" ~ "7.4",
patch == "7.5" ~ "7.5",
patch %in% c("7.6", "7.7", "7.8") ~ "7.6-7.8",
patch %in% c("7.9", "7.10") ~ "7.9-7.10",
patch %in% c("7.11", "7.12", "7.13") ~ "7.11-7.13",
patch %in% c("7.14", "7.15", "7.16", "7.17", "7.18") ~ "7.14-7.18",
TRUE                     ~ "undefined")) %>%
select(
name, patch2,
games,
#summoners,
winrate,
#DPS,
DmgDealt = totalDamageToChampions,
kills,
assists,
deaths,
DmgTaken = totalDamageTaken,
cs = csPerGame,
gold = goldEarned
)
dfprep = data.table(dfprep)
df = dfprep %>%
rownames_to_column( var = "champ" ) %>%
mutate_each(funs(rescale), -c(champ,name,patch2)) %>%
melt(id.vars=c('champ','name','patch2'), measure.vars=colnames(dfprep[,-c("name","patch2")])) %>%
arrange(champ)
df = data.table(df)
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(axis.text.x = element_text(size = 5),
legend.position="none",
axis.ticks.x = element_line(size=3),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c(adc.set1, adc.set2))
df
# OVERALL
dfprep = adc.performance.patch %>%
mutate(DPS = totalDamageToChampions/gameDuration) %>%
mutate(patch2 =
dplyr::case_when(patch %in% c("6.23", "6.24") ~ "Pre-Season",
patch %in% c("7.1", "7.2", "7.3") ~ "7.1-7.3",
patch == "7.4" ~ "7.4",
patch == "7.5" ~ "7.5",
patch %in% c("7.6", "7.7", "7.8") ~ "7.6-7.8",
patch %in% c("7.9", "7.10") ~ "7.9-7.10",
patch %in% c("7.11", "7.12", "7.13") ~ "7.11-7.13",
patch %in% c("7.14", "7.15", "7.16", "7.17", "7.18") ~ "7.14-7.18",
TRUE                     ~ "undefined")) %>%
group_by(name,patch2) %>%
summarise(
games = sum(games),
#summoners,
winrate = mean(winrate),
#DPS,
DmgDealt = mean(totalDamageToChampions),
kills = mean(kills),
assists = mean(assists),
deaths = mean(deaths),
DmgTaken = mean(totalDamageTaken),
cs = mean(csPerGame),
gold = mean(goldEarned)
)
dfprep = data.table(dfprep)
df = dfprep %>%
rownames_to_column( var = "champ" ) %>%
mutate_each(funs(rescale), -c(champ,name,patch2)) %>%
melt(id.vars=c('champ','name','patch2'), measure.vars=colnames(dfprep[,-c("name","patch2")])) %>%
arrange(champ)
df = data.table(df)
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(axis.text.x = element_text(size = 5),
legend.position="none",
axis.ticks.x = element_line(size=3),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c(adc.set1, adc.set2))
radarChart(c(adc.set3))
radarChart(c("Ashe", "Jhin", "Varus"))
radarChart(c("Caitlyn", "Draven","Ashe", "Jhin", "Varus"))
radarChart(c("Caitlyn", "Draven","Ashe", "Ezreal",  "Jhin", "Varus", "Vayne"))
radarChart(c("Caitlyn", "Draven","Ashe", "Ezreal",  "Jhin", "Varus"))
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 5),
axis.ticks.x = element_line(size = 3),
axis.ticks.x = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 5),
axis.ticks.x = element_line(size = 3),
axis.ticks.x = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Caitlyn", "Draven","Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 5),
axis.ticks.x = element_line(size = 3),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Caitlyn", "Draven","Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 5),
axis.ticks.x = element_line(size = 8),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 8),
axis.ticks.x = element_line(size = 8),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
labs(title="Radar Charts describing KPIs for Champions through Season 7")
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 8),
axis.ticks.x = element_line(size = 8),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
labs(title="Radar Charts describing KPIs for Champions through Season 7") +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
axis.text.x = element_text(size = 8),
axis.ticks.x = element_line(size = 8),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
radarChart <- function(adc.set) {
p <- df[name %in% c(adc.set)] %>%
ggplot(aes(x=variable, y=value, group=name, color=name)) +
geom_polygon() +
labs(title="Radar Charts describing KPIs for Champions through Season 7") +
coord_radar() + theme_bw() + facet_grid(name~factor(patch2, levels=c("Pre-Season", "7.1-7.3","7.4","7.5","7.6-7.8","7.9-7.10","7.11-7.13","7.14-7.18"))) +
scale_x_discrete(labels = abbreviate) +
theme(legend.position="none",
title = element_text(size = 20),
axis.text.x = element_text(size = 8),
axis.ticks.x = element_line(size = 8),
axis.ticks.y = element_line(size = 8),
axis.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank())
return(p)
}
radarChart(c("Ashe", "Ezreal",  "Jhin", "Varus"))
# damage done to champions
adc.performance.patch[championId %in% relchamps.adc] %>%
ggplot(aes(y = totalDamageToChampions, x = patch, group=name)) +
geom_line() +
scale_x_discrete(limits=patchOrder) +
facet_wrap(~name, ncol = 4)
adc.performance.patch
adc
p <- ggplot(data=sup.distribution,aes(x=names, y=gamesPlayed)) +
geom_bar(stat='identity') +
scale_x_discrete(limits=sup.distribution[order(by=gamesPlayed,decreasing = T)]$names) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6))
p
p <- ggplot(data=sup.distribution,aes(x=names, y=gamesPlayed)) +
geom_bar(stat='identity') +
scale_x_discrete(limits=sup.distribution[order(by=gamesPlayed,decreasing = T)]$names) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6))
p
## support
sup <- data.table(dbGetQuery(conn = connection, "SELECT * FROM playerdetails WHERE lane = 'BOTTOM' AND role = 'DUO_SUPPORT' AND gameDuration >= 900"))
relchamps.sup <- sup[,list(gamesPlayed = .N), by = championId][order(by = gamesPlayed, decreasing = T)][,.SD[1:24]][,championId]
sup.relevant <- sup[championId %in% relchamps.sup]
sup.performance <- champPerformancePatchRegion[lane=="BOTTOM" & role == "DUO_SUPPORT" & championId %in% unique(sup.relevant$championId)]
sup.distribution <- merge(
data.table(sup[,list(gamesPlayed = .N), by = championId][order(by = gamesPlayed, decreasing = T)]),
champLookUp,
by= "championId"
)
sup.distribution.platform <- merge(
data.table(sup[,list(gamesPlayed = .N), by = list(championId,platformId)][order(by = gamesPlayed, decreasing = T)]),
champLookUp,
by= "championId"
)
sup.distribution.patch <- merge(
data.table(sup[,list(gamesPlayed = .N), by = list(championId,patch)][order(by = gamesPlayed, decreasing = T)]),
champLookUp,
by= "championId"
)
setnames(sup.distribution,"name", "names")
items.sup = rbind(
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item0)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item1)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item2)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item3)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item4)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item5)],
sup[championId %in% relchamps.sup,list(championId, platformId, patch, item=item6)]
)
p <- ggplot(data = sup.performance[championId %in% relchamps.sup], aes(x = patch, y=games/2000 * 100, group=platformId, color=platformId)) +
geom_line(linetype = 1) +
#geom_line(data = adc.performance , aes(y = winrate), linetype = 2) +
scale_x_discrete(limits=patchOrder) +
theme(axis.text.x = element_text(size=5)) +
labs(x = "Patch", y = "Playrate in Percentage") +
facet_wrap(~ name, ncol = 4)
p + ggtitle("Support Picks per Patch and Region")
#Linechart
p <- ggplot(data = sup.performance[championId %in% relchamps.sup], aes(x = patch, y=games/10000 * 100, group=platformId, color=platformId)) +
geom_line(linetype = 1) +
scale_x_discrete(limits=patchOrder) +
theme(axis.text.x = element_text(size=5)) +
labs(x = "Patch", y = "Playrate in Percentage") +
facet_wrap(~ name, ncol = 4)
p + ggtitle("Support Picks per Patch and Region")
p <- ggplot(data=sup.distribution,aes(x=names, y=gamesPlayed)) +
geom_bar(stat='identity', fill="#56B4E9") +
scale_x_discrete(limits=sup.distribution[order(by=gamesPlayed,decreasing = T)][1:30]$names) +
labs(x = "Champion", y = "#matches", title="Distribution of Top 30 ADCs played in Season 7") +
theme_bw() +
theme(axis.text.x = element_text(size=16,angle = 90, hjust = 1),
axis.text.y = element_text(size=6),
title = element_text(size=40),
axis.title = element_text(size=24))
p
sup.distribution
p <- ggplot(data=sup.distribution,aes(x=names, y=gamesPlayed)) +
geom_bar(stat='identity') +
scale_x_discrete(limits=sup.distribution[order(by=gamesPlayed,decreasing = T)]$names) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6))
p
p <- ggplot(data=sup.distribution,aes(x=names, y=gamesPlayed)) +
geom_bar(stat='identity', fill="#56B4E9") +
scale_x_discrete(limits=sup.distribution[order(by=gamesPlayed,decreasing = T)][1:30]$names) +
labs(x = "Champion", y = "#matches", title="Distribution of Top 30 Supports played in Season 7") +
theme_bw() +
theme(axis.text.x = element_text(size=16,angle = 90, hjust = 1),
axis.text.y = element_text(size=6),
title = element_text(size=40),
axis.title = element_text(size=24))
p
p <- ggplot(data = sup.performance, aes(x=name, y=games/10000 *100, fill = name)) +
geom_bar(stat="Identity") +
facet_wrap( ~ platformId+factor(patch, levels = patchOrder), nrow=4) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6)) +
labs(x = "Champion", y = "Playrate in Percentages") +
coord_flip() +
guides(fill=F)
p+ ggtitle("Support Picks per Patch and Region")
botlane %>%
filter(sup.Id %in% relchamps.sup) %>%
group_by(ad,sup,patch) %>%
summarise(count =n()) %>%
left_join(botlane %>% group_by(ad, patch) %>% summarise(adCount = n())) %>%
mutate(perc = count/adCount) %>%
ggplot(aes(x = sup, y = perc)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6)) +
coord_flip() +
facet_grid(ad~factor(patch, levels=patchOrder))
botlane adc+sup:
botlane = data.table(
merge(adc.relevant,
sup.relevant,
by = c("gameId", "platformId", "teamId")
)
) %>%
select(
gameId,
platformId,
teamId = teamId,
patch = patch.x,
gameDuration = gameDuration.x,
ad.Id = championId.x,
sup.Id = championId.y,
win = win.x,
ad.DamageToChampions= totalDamageDealtToChampions.x,
sup.DamageToChampions = totalDamageDealtToChampions.y,
ad.kills = kills.x,
ad.assists = assists.x,
ad.deaths = deaths.x,
sup.kills = kills.y,
sup.assists = assists.y,
sup.deaths = deaths.y
) %>%
mutate(
ad.kda = (ad.kills+ad.assists)/ifelse(ad.deaths ==0,1,ad.deaths)
) %>%
inner_join(select(champLookUp, championId, ad=name), by=c("ad.Id" = "championId"))  %>%
inner_join(select(champLookUp, championId, sup=name), by=c("sup.Id" = "championId"))
#Barchart
majorRegions =  c("TRLH1", #naLCS
"TRLH3", #euLCS
"TRTW", #lms
"ESPORTSTMNT06", #lck
"ESPORTSTMNT03" #cbLoL and TCL
)
p <- ggplot(data = adc.pro.performance[platformId %in% majorRegions], aes(x=name, y=playrate *100, fill = name)) +
geom_bar(stat="Identity") +
facet_wrap( ~ platformId+factor(patch, levels = patchOrder), nrow=5) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), axis.text.y = element_text(size=6)) +
labs(x = "Champion", y = "Playrate in Percentages") +
coord_flip() +
guides(fill=F)
p+ ggtitle("ADC Picks per Patch and Region")
p
#Linechart
p <- ggplot(data = adc.pro.performance[platformId %in% majorRegions], aes(x = patch, y=playrate * 100, group=platformId, color=platformId)) +
geom_line(linetype = 1) +
#geom_line(data = adc.performance , aes(y = winrate), linetype = 2) +
scale_x_discrete(limits=patchOrder) +
theme(axis.text.x = element_text(size=5)) +
labs(x = "Patch", y = "Playrate in Percentage") +
facet_wrap(~ name, ncol = 4)
p + ggtitle("ADC Picks per Patch and Region")
df1$variableNew <- c(0,25,30,35,40,45,50)[match(df1$variable, c("winrate", "winrateAt25", "winrateAt30", "winrateAt35", "winrateAt40","winrateAt45", "winrateOver45"))]
winrate_scale = c("winrateAt25", "winrateAt30", "winrateAt35", "winrateAt40","winrateAt45", "winrateOver45")
p = ggplot(data = df1[variableNew!=0], aes(x = variableNew, y=value, color = name)) +
geom_point() +
geom_smooth(method="auto") +
facet_grid(name ~ factor(patch, levels = patchOrder)) +
scale_y_continuous(limits=c(0,1)) +
scale_x_continuous(limits = c(20,55), breaks = seq(25,50,5), labels=c( "25", "30", "35" ,"40", "45", ">45")) +
theme(legend.position="none")
p
